<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Search Filter Test</title>
</head>
<body>
    <div id="viewer"></div>
    <div id="test-results"></div>
    
    <script src="search-pro-non-mod/search-01-non-mod.js"></script>
    
    <script>
        // Test the filtering logic
        document.addEventListener('DOMContentLoaded', function() {
            const testResults = document.getElementById('test-results');
            
            function runTests() {
                testResults.innerHTML = '<h2>Filter Tests</h2>';
                
                // Mock tour data
                window.tour = {
                    mainPlayList: {
                        get: function(key) {
                            if (key === 'items') {
                                return [
                                    {
                                        get: (k) => k === 'media' ? { 
                                            get: (mk) => mk === 'overlays' ? [
                                                {
                                                    get: (ok) => {
                                                        if (ok === 'label') return 'Polygon-01-Hotspot';
                                                        if (ok === 'id') return 'poly1';
                                                        return null;
                                                    },
                                                    vertices: [[0,0], [1,1], [2,0]]
                                                },
                                                {
                                                    get: (ok) => {
                                                        if (ok === 'label') return '';
                                                        if (ok === 'id') return 'unnamed1';
                                                        return null;
                                                    }
                                                }
                                            ] : null
                                        } : null
                                    }
                                ];
                            }
                            return null;
                        }
                    }
                };
                
                // Test whitelist filtering
                if (window.searchFunctions && window.searchFunctions.updateConfig) {
                    // Test 1: Whitelist "Polygon-01-Hotspot"
                    testResults.innerHTML += '<h3>Test 1: Whitelist "Polygon-01-Hotspot"</h3>';
                    window.searchFunctions.updateConfig({
                        filter: {
                            mode: "whitelist",
                            allowedValues: ["Polygon-01-Hotspot"]
                        }
                    });
                    
                    // Test 2: Blacklist "[Unnamed Item]"
                    setTimeout(() => {
                        testResults.innerHTML += '<h3>Test 2: Blacklist "[Unnamed Item]"</h3>';
                        window.searchFunctions.updateConfig({
                            filter: {
                                mode: "blacklist",
                                blacklistedValues: ["[Unnamed Item]"]
                            },
                            includeContent: {
                                elements: {
                                    skipEmptyLabels: false
                                }
                            }
                        });
                    }, 1000);
                }
            }
            
            // Initialize search and run tests
            if (window.tourSearchInit) {
                window.tourSearchInit();
                setTimeout(runTests, 500);
            }
        });
    </script>
</body>
</html>
