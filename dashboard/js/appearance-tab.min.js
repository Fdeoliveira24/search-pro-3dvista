/* Search Pro v3.1 - Last Update on 10/31/2025 - Race Condition Fix */
console.log("========================================"),console.log("APPEARANCE TAB JS FILE LOADED SUCCESSFULLY"),console.log("========================================"),console.log("üö®üö®üö® APPEARANCE-TAB.JS FILE IS LOADING! üö®üö®üö®");class AppearanceTabHandler{constructor(){this.core=null,this.tabId="appearance",console.log("APPEARANCE TAB HANDLER CONSTRUCTOR CALLED!"),console.log("üö®üö®üö® APPEARANCE TAB HANDLER CONSTRUCTOR CALLED! üö®üö®üö®")}setCore(e){this.core=e}init(e){try{console.log("üö®üö®üö® APPEARANCE TAB INIT CALLED! üö®üö®üö®"),console.log("üö® Container received:",e),console.log("üö® Core instance:",this.core),this.core.setupFormListeners(e),this.setupAppearanceHandlers(e),this.setupBorderRadiusValidation(e),this.core.populateForm(e),this.validateForm(e),console.log("‚úÖ Appearance tab handler initialized")}catch(e){console.error("‚ùå Error initializing Appearance tab:",e)}}setupAppearanceHandlers(e){try{this.setupColorPickerHandlers(e),this.setupRangeSliderHandlers(e),this.setupResetButtonHandlers(e),this.setupTypographyHandlers(e),console.log("üé® Appearance handlers initialized")}catch(e){console.error("üö® Security: Error setting up appearance handlers:",e)}}setupColorPickerHandlers(e){try{console.log("üö®üö®üö® SETUP COLOR PICKER HANDLERS CALLED! üö®üö®üö®"),console.log("üö® Container:",e);const r=e.querySelectorAll(".color-input");console.log(`üî• CRITICAL: Found ${r.length} color inputs in appearance tab`);const o=e.querySelector("#groupHeaderBackground");console.log("üî• CRITICAL: groupHeaderBackground element found:",o),o&&console.log(`üî• CRITICAL: groupHeaderBg id="${o.id}", value="${o.value}"`),r.forEach(e=>{console.log(`üî• CRITICAL: Processing color input: id="${e.id}"`),"groupHeaderBackground"===e.id&&console.log("üî• CRITICAL: FOUND GROUP HEADER BACKGROUND INPUT!");const r=e.parentNode.querySelector(".color-hex-input");r?(e.addEventListener("input",e=>{console.log(`üî• CRITICAL: Color input changed: ${e.target.id} = ${e.target.value}`),"groupHeaderBackground"===e.target.id&&(console.log("üî• CRITICAL: GROUP HEADER BACKGROUND EVENT FIRED!"),console.log("üî• CRITICAL: About to call onFormChange and applyColorLivePreview")),r.value=e.target.value,r.classList.remove("error"),this.core.onFormChange(e.target),this.applyColorLivePreview(e.target.id,e.target.value),"groupHeaderBackground"===e.target.id&&console.log("üî• CRITICAL: Finished onFormChange and applyColorLivePreview for groupHeaderBackground"),"resultIconColor"===e.target.id&&this.syncIconColors(e.target.value)}),r.addEventListener("input",o=>{/^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/.test(o.target.value)?(console.log(`üî• CRITICAL: HEX input changed: ${e.id} = ${o.target.value}`),"groupHeaderBackground"===e.id&&(console.log("üî• CRITICAL: GROUP HEADER BACKGROUND HEX EVENT FIRED!"),console.log("üî• CRITICAL: About to call onFormChange and applyColorLivePreview for HEX")),e.value=o.target.value,r.classList.remove("error"),this.core.onFormChange(e),this.applyColorLivePreview(e.id,e.value),"groupHeaderBackground"===e.id&&console.log("üî• CRITICAL: Finished onFormChange and applyColorLivePreview for groupHeaderBackground HEX"),"resultIconColor"===e.id&&this.syncIconColors(o.target.value)):r.classList.add("error")}),r.value=e.value):console.log(`üî• CRITICAL: No hex input found for ${e.id}`)}),console.log(`üé® Color picker handlers set up for ${r.length} inputs`)}catch(e){console.error("üö® Error setting up color picker handlers:",e)}}getContrastColor(e){return(.299*parseInt(e.substr(1,2),16)+.587*parseInt(e.substr(3,2),16)+.114*parseInt(e.substr(5,2),16))/255>.5?"#000000":"#ffffff"}setupRangeSliderHandlers(e){try{const r=e.querySelectorAll(".range-input");r.forEach(e=>{const r=e=>{const r=e.target.parentNode.querySelector(".range-value");r&&(r.textContent=e.target.value,r.classList.add("updated"),setTimeout(()=>r.classList.remove("updated"),500)),this.core.onFormChange(e.target),"highlightOpacity"===e.target.id&&this.applyHighlightOpacityPreview(e.target.value)};e.addEventListener("input",r),e.addEventListener("change",r)}),console.log(`üìä Range slider handlers set up for ${r.length} inputs`)}catch(e){console.error("üö® Error setting up range slider handlers:",e)}}applyHighlightOpacityPreview(e){try{document.documentElement.style.setProperty("--search-highlight-bg-opacity",e)}catch(e){console.error("üö® Error applying highlight opacity preview:",e)}}setupResetButtonHandlers(e){try{const r=e.querySelectorAll(".reset-section-button");r.forEach(e=>{const r=e.cloneNode(!0);e.parentNode.replaceChild(r,e),r.addEventListener("click",e=>{e.preventDefault();const r=e.target.closest("button").dataset.section;r&&this.resetColorSection(r)})}),console.log(`üîÑ Reset button handlers set up for ${r.length} buttons (duplicates prevented)`)}catch(e){console.error("üö® Error setting up reset button handlers:",e)}}setupTypographyHandlers(e){try{console.log("üéØ TYPOGRAPHY SETUP: Starting typography handlers setup");const r=e.querySelector('section[aria-labelledby="typography-heading"]');if(r)console.log("üéØ TYPOGRAPHY SETUP: Typography section found");else{if(console.warn("üéØ TYPOGRAPHY SETUP: Typography section not found"),!(e.querySelector('[data-section="typography"]')||e.querySelector(".typography-section")||e.querySelector("#typography-settings")))return void console.log("üéØ TYPOGRAPHY SETUP: No typography section found - skipping typography setup");console.log("üéØ TYPOGRAPHY SETUP: Found typography section via alternative selector")}const o=r||e.querySelector('[data-section="typography"]');if(!o)return void console.log("üéØ TYPOGRAPHY SETUP: No valid typography section available - skipping");const t=o.querySelectorAll(".form-select");console.log(`üéØ TYPOGRAPHY SETUP: Found ${t.length} select elements`),t.forEach((e,r)=>{console.log(`üéØ TYPOGRAPHY SETUP: Setting up select ${r+1} with ID: ${e.id}`),e.addEventListener("change",e=>{console.log(`üéØ TYPOGRAPHY EVENT: Select changed - ${e.target.id} = ${e.target.value}`),this.core.onFormChange(e.target),this.applyTypographyPreview(e.target.id,e.target.value)})});const a=o.querySelectorAll('input[id^="input"], input[id^="placeholder"], input[id^="focus"]');console.log(`üéØ TYPOGRAPHY SETUP: Found ${a.length} input elements`),a.forEach((e,r)=>{console.log(`üéØ TYPOGRAPHY SETUP: Setting up input ${r+1} with ID: ${e.id}, type: ${e.type}`),e.addEventListener("change",e=>{console.log(`üéØ TYPOGRAPHY EVENT: Input change - ${e.target.id} = ${e.target.value}`),this.core.onFormChange(e.target),this.applyTypographyPreview(e.target.id,e.target.value)}),e.addEventListener("input",e=>{console.log(`üéØ TYPOGRAPHY EVENT: Input input - ${e.target.id} = ${e.target.value}`),this.applyTypographyPreview(e.target.id,e.target.value)})}),console.log(`üéØ TYPOGRAPHY SETUP COMPLETE: ${t.length} selects and ${a.length} inputs configured`)}catch(e){console.error("üö® TYPOGRAPHY SETUP ERROR:",e),console.error("üö® Error stack:",e.stack)}}applyColorLivePreview(e,r){try{const o={searchBackground:"--search-background",searchText:"--search-text",placeholderText:"--placeholder-text",searchIcon:"--search-icon",clearIcon:"--clear-icon",resultsBackground:"--results-background",resultText:"--result-text",resultHover:"--result-hover",resultBorderLeft:"--result-border-left",groupHeaderBackground:"--group-header-bg",groupHeaderColor:"--group-header",groupCountColor:"--group-count",resultSubtitle:"--result-subtitle",resultIconColor:"--result-icon-color",resultSubtextColor:"--result-subtext-color",highlightBackground:"--search-highlight-bg",highlightText:"--search-highlight-color",tagBackground:"--tag-background",tagText:"--tag-text",tagBorder:"--tag-border"},t=e.split(".").pop(),a=o[e]||o[t];if(console.log(`üé® COLOR PREVIEW: ${e} = ${r} -> ${a}`),a){document.documentElement.style.setProperty(a,r);const o=JSON.parse(JSON.stringify(this.core.config));if(this.core.safeSetNestedProperty(o,e,r),this.core.safeLocalStorageSet("searchProLiveConfig",o),window.parent&&window.parent!==window)try{window.parent.postMessage({type:"searchProColorPreview",cssVariable:a,value:r,field:this.core.sanitizeInput(e),config:o},"*"),console.log(`üé® LIVE PREVIEW: Sent color update to parent tour - ${a}: ${r}`)}catch(e){console.warn("ÔøΩ Error sending color preview to parent tour:",e)}console.log(`üé® Color live preview applied: ${e} -> ${a}: ${r}`)}else console.warn(`üé® No CSS variable mapping found for ${e} (shortField: ${t})`)}catch(e){console.error("üö® Error applying color live preview:",e)}}applyBorderRadiusLivePreview(e,r){try{const o={searchBorderTopLeft:"--search-field-radius-top-left",searchBorderTopRight:"--search-field-radius-top-right",searchBorderBottomLeft:"--search-field-radius-bottom-left",searchBorderBottomRight:"--search-field-radius-bottom-right",resultsBorderTopLeft:"--search-results-radius-top-left",resultsBorderTopRight:"--search-results-radius-top-right",resultsBorderBottomLeft:"--search-results-radius-bottom-left",resultsBorderBottomRight:"--search-results-radius-bottom-right",tagBorderRadius:"--tag-border-radius"},t=e.split(".").pop(),a=o[e]||o[t];if(a){document.documentElement.style.setProperty(a,`${r}px`);const o=document.getElementById("livePreviewPanel");o&&o.style.setProperty(a,`${r}px`),console.log(`üîÑ Applied border radius preview for ${e}: ${r}px`)}}catch(e){console.error("üö® Error applying border radius live preview:",e)}}applyTypographyPreview(e,r){try{console.log(`üéØ TYPOGRAPHY CHANGE DEBUG: Field ${e} changed to: ${r}`),console.log("üéØ TYPOGRAPHY TRIGGER: applyTypographyPreview called");const o={inputFontSize:"appearance.searchField.typography.fontSize",inputFontFamily:"appearance.searchField.typography.fontFamily",inputFontWeight:"appearance.searchField.typography.fontWeight",inputFontStyle:"appearance.searchField.typography.fontStyle",inputLineHeight:"appearance.searchField.typography.lineHeight",inputLetterSpacing:"appearance.searchField.typography.letterSpacing",inputTextTransform:"appearance.searchField.typography.textTransform",placeholderFontSize:"appearance.searchField.typography.placeholder.fontSize",placeholderFontFamily:"appearance.searchField.typography.placeholder.fontFamily",placeholderFontWeight:"appearance.searchField.typography.placeholder.fontWeight",placeholderFontStyle:"appearance.searchField.typography.placeholder.fontStyle",placeholderOpacity:"appearance.searchField.typography.placeholder.opacity",placeholderLetterSpacing:"appearance.searchField.typography.placeholder.letterSpacing",placeholderTextTransform:"appearance.searchField.typography.placeholder.textTransform",focusFontSize:"appearance.searchField.typography.focus.fontSize",focusFontWeight:"appearance.searchField.typography.focus.fontWeight",focusLetterSpacing:"appearance.searchField.typography.focus.letterSpacing"},t=o[e];if(console.log(`üéØ TYPOGRAPHY PATH DEBUG: ${e} maps to: ${t}`),t){let e;const o=this.core.safeLocalStorageGet("searchProLiveConfig");o?(e=JSON.parse(JSON.stringify(o)),console.log("üéØ USING EXISTING LIVE CONFIG from localStorage")):(e=JSON.parse(JSON.stringify(this.core.config)),console.log("üéØ USING BASE CONFIG (no live config exists)")),console.log("üéØ BEFORE UPDATE: Current config structure:",{hasAppearance:!!e.appearance,hasSearchField:!!e.appearance?.searchField,hasTypography:!!e.appearance?.searchField?.typography}),this.core.safeSetNestedProperty(e,t,r),console.log(`üéØ AFTER UPDATE: Config path ${t} set to: ${r}`);const a=this.core.getNestedProperty(e,t);console.log(`üéØ VERIFICATION: Retrieved value from ${t}: ${a}`),this.core.safeLocalStorageSet("searchProLiveConfig",e),console.log("üéØ SAVED TO LOCALSTORAGE: searchProLiveConfig updated");const n=e.appearance?.searchField?.typography;console.log("üéØ FULL TYPOGRAPHY CONFIG:",JSON.stringify(n,null,2));const l=this.core.safeLocalStorageGet("searchProLiveConfig");console.log("üéØ LOCALSTORAGE VERIFICATION:",{configExists:!!l,typographyExists:!!l?.appearance?.searchField?.typography,savedValue:this.core.getNestedProperty(l,t)})}else console.warn(`üéØ WARNING: No config mapping found for typography field: ${e}`),console.log("üéØ Available mappings:",Object.keys(o))}catch(e){console.error("üö® TYPOGRAPHY ERROR:",e),console.error("üö® Error stack:",e.stack)}}resetColorSection(e){try{const r=this.core.getDefaultConfig();let o={};switch(e){case"searchField":o={searchBackground:r.appearance.colors.searchBackground,searchText:r.appearance.colors.searchText,placeholderText:r.appearance.colors.placeholderText,searchIcon:r.appearance.colors.searchIcon,clearIcon:r.appearance.colors.clearIcon};break;case"searchResults":o={resultsBackground:r.appearance.colors.resultsBackground,resultText:r.appearance.colors.resultText,resultHover:r.appearance.colors.resultHover,resultBorderLeft:r.appearance.colors.resultBorderLeft,groupHeaderBackground:r.appearance.colors.groupHeaderBackground,groupHeaderColor:r.appearance.colors.groupHeaderColor,groupCountColor:r.appearance.colors.groupCountColor,resultSubtitle:r.appearance.colors.resultSubtitle,resultIconColor:r.appearance.colors.resultIconColor,resultSubtextColor:r.appearance.colors.resultSubtextColor};break;case"highlight":o={highlightBackground:r.appearance.colors.highlightBackground,highlightText:r.appearance.colors.highlightText,highlightBackgroundOpacity:r.appearance.colors.highlightBackgroundOpacity};const e=document.getElementById("highlightOpacity");if(e){e.value=r.appearance.colors.highlightBackgroundOpacity;const o=e.parentNode.querySelector(".range-value");o&&(o.textContent=r.appearance.colors.highlightBackgroundOpacity)}break;case"tags":o={tagBackground:r.appearance.colors.tagBackground,tagText:r.appearance.colors.tagText,tagBorder:r.appearance.colors.tagBorder};break;case"typography":return this.resetTypographySection(),void this.core.showToast("success","Typography Reset","Typography settings restored to defaults")}Object.keys(o).forEach(e=>{const r=document.getElementById(e);if(r){r.value=o[e];const t=r.parentNode.querySelector(".color-hex-input");t&&(t.value=r.value.toLowerCase(),t.classList.remove("error")),this.core.onFormChange(r)}}),console.log(`üé® ${e} colors reset to defaults`)}catch(e){console.error("üö® Error resetting color section:",e)}}resetTypographySection(){try{const e=this.core.getDefaultConfig().appearance.searchField.typography;this.setFormValue("inputFontSize",e.fontSize),this.setFormValue("inputFontFamily",e.fontFamily),this.setFormValue("inputFontWeight",e.fontWeight),this.setFormValue("inputFontStyle",e.fontStyle),this.setFormValue("inputLineHeight",e.lineHeight),this.setFormValue("inputLetterSpacing",e.letterSpacing),this.setFormValue("inputTextTransform",e.textTransform),this.setFormValue("placeholderFontSize",e.placeholder.fontSize),this.setFormValue("placeholderFontFamily",e.placeholder.fontFamily),this.setFormValue("placeholderFontWeight",e.placeholder.fontWeight),this.setFormValue("placeholderFontStyle",e.placeholder.fontStyle),this.setFormValue("placeholderOpacity",e.placeholder.opacity),this.setFormValue("placeholderLetterSpacing",e.placeholder.letterSpacing),this.setFormValue("placeholderTextTransform",e.placeholder.textTransform),this.setFormValue("focusFontSize",e.focus.fontSize),this.setFormValue("focusFontWeight",e.focus.fontWeight),this.setFormValue("focusLetterSpacing",e.focus.letterSpacing),console.log("üìù Typography reset to defaults")}catch(e){console.error("üö® Error resetting typography:",e)}}setFormValue(e,r){try{const o=this.core.sanitizeInput(e,100),t=document.getElementById(o);if(!t)return;if("checkbox"===t.type)t.checked=Boolean(r);else if("color"===t.type){t.value=r||"#000000";const e=t.parentNode.querySelector(".color-hex");e&&(e.textContent=t.value.toLowerCase())}else if("range"===t.type){t.value=null===r?"":String(r);const e=t.parentNode.querySelector(".range-value");e&&(e.textContent=String(r))}else t.value="string"==typeof r?this.core.sanitizeInput(r):null===r?"":String(r)}catch(e){console.error("üö® Security: Error setting form value:",e)}}validateField(e){try{const r="checkbox"===e.type?e.checked:e.value,o=this.core.sanitizeInput(e.name||e.id,100);let t=!0;switch(t=this.core.validateField(e),!0){case o.includes("borderRadius")||o.includes("BorderRadius"):return this.validateBorderRadiusField(e);case"tagBorderRadius"===o:(r<0||r>20)&&(t=!1);break;case o.includes("Opacity"):(r<0||r>1)&&(t=!1)}return t?(e.classList.remove("error"),e.classList.add("valid")):e.classList.add("error"),t}catch(e){return console.error("üö® Security: Error in Appearance tab field validation:",e),!1}}validateBorderRadiusField(e){try{const r=parseFloat(e.value);return e.name||e.id,e.classList.remove("error","warning"),this.clearValidationMessage(e),r<0?(e.classList.add("error"),this.showValidationMessage(e,"error","Border radius cannot be negative",5e3),!1):r>50?(e.classList.add("error"),this.showValidationMessage(e,"error","Border radius cannot exceed 50px for optimal display",5e3),!1):r>35?(e.classList.add("warning"),this.showValidationMessage(e,"warning","Recommended: 0-35px. Max 50px",3e3),!0):(e.classList.add("valid"),!0)}catch(e){return console.error("Error validating border radius field:",e),!1}}setupBorderRadiusValidation(e){try{const r=e.querySelectorAll('input[name*="borderRadius"], input[id*="BorderRadius"], input[id*="borderRadius"]');r.forEach(e=>{e.addEventListener("input",e=>{this.validateBorderRadiusField(e.target)}),e.addEventListener("blur",e=>{this.validateBorderRadiusField(e.target)})}),console.log(`üé® Border radius validation setup for ${r.length} fields`)}catch(e){console.error("Error setting up border radius validation:",e)}}showValidationMessage(e,r,o,t=3e3){try{if("function"==typeof window.showValidationMessage)return void window.showValidationMessage(e,r,o,t);this.clearValidationMessage(e);const a=document.createElement("div");a.className=`validation-message validation-${r}`,a.textContent=o,a.id=`${e.id}-validation`,a.style.cssText=`\n        position: absolute;\n        top: 100%;\n        left: 0;\n        background: ${"error"===r?"#ef4444":"#f59e0b"};\n        color: white;\n        padding: 4px 8px;\n        border-radius: 4px;\n        font-size: 12px;\n        z-index: 1000;\n        white-space: nowrap;\n        margin-top: 2px;\n      `,e.parentNode.style.position="relative",e.parentNode.appendChild(a),setTimeout(()=>{this.clearValidationMessage(e)},t),console.log(`üé® Validation message shown: ${r} - ${o}`)}catch(e){console.error("Error showing validation message:",e)}}clearValidationMessage(e){try{if("function"==typeof window.clearValidationMessage)return void window.clearValidationMessage(e.id);const r=document.getElementById(`${e.id}-validation`);r&&r.remove()}catch(e){console.error("Error clearing validation message:",e)}}syncIconColors(e){try{const r=document.querySelector("#iconColor"),o=document.querySelector("#iconColor + .color-hex-input");r&&(r.value=e,this.core.setNestedValue(this.core.config,"thumbnailSettings.iconSettings.iconColor",e)),o&&(o.value=e.toUpperCase()),console.log(`üé® Synced Result Icon Color with Icon Color: ${e}`)}catch(e){console.error("Error syncing icon colors:",e)}}validateForm(e=document){try{const r=e.querySelectorAll(".form-input, .toggle-input, .color-input, .range-input, .form-select");let o=!0;const t=[],a=[];return r.forEach(e=>{this.validateField(e)||(o=!1,t.push(`Invalid value in field: ${e.name||e.id||"unknown field"}`))}),console.log("üé® Appearance tab validation: "+(o?"PASSED":"FAILED")),{isValid:o,errors:t,warnings:a}}catch(e){return console.error("üö® Security: Error validating Appearance tab form:",e),{isValid:!1,errors:["Validation error occurred"],warnings:[]}}}applyLivePreview(e,r){try{const o=["searchBackground","searchText","placeholderText","searchIcon","clearIcon","resultsBackground","resultText","resultHover","resultBorderLeft","groupHeaderBackground","groupHeaderColor","groupCountColor","resultSubtitle","resultIconColor","resultSubtextColor"],t=["searchBorderTopLeft","searchBorderTopRight","searchBorderBottomLeft","searchBorderBottomRight","resultsBorderTopLeft","resultsBorderTopRight","resultsBorderBottomLeft","resultsBorderBottomRight"];if(e.includes("appearance.colors")||o.includes(e))this.applyColorLivePreview(e,r);else if(e.includes("borderRadius")||t.includes(e))this.applyBorderRadiusLivePreview(e,r);else if(e.includes("typography")||e.includes("Font")||e.includes("placeholder")||e.includes("focus"))this.applyTypographyPreview(e,r);else{const o=JSON.parse(JSON.stringify(this.core.config));if(this.core.safeSetNestedProperty(o,e,r),this.core.safeLocalStorageSet("searchProLiveConfig",o),window.parent&&window.parent!==window)try{window.parent.postMessage({type:"searchProConfigPreview",config:o,field:this.core.sanitizeInput(e),value:"string"==typeof r?this.core.sanitizeInput(r):r},"*")}catch(e){console.warn("üö® Security: Error posting message to parent:",e)}}}catch(e){console.warn("üö® Security: Appearance tab live preview failed:",e)}}resetToDefaults(){try{console.log("üîÑ Resetting Appearance tab to defaults");const e=this.core.getDefaultConfig();this.core.config.appearance=JSON.parse(JSON.stringify(e.appearance));const r=document.getElementById("appearance-panel");r&&(this.core.populateForm(r),this.setupAppearanceHandlers(r)),console.log("‚úÖ Appearance tab reset complete")}catch(e){console.error("üö® Security: Error resetting Appearance tab:",e)}}getConfigSummary(){try{return{tab:"Appearance",sections:{searchField:this.core.config.appearance.searchField,searchResults:this.core.config.appearance.searchResults,colors:this.core.config.appearance.colors,tags:this.core.config.appearance.tags}}}catch(e){return console.error("üö® Security: Error getting Appearance tab config summary:",e),null}}cleanup(){try{document.documentElement.removeAttribute("style"),console.log("üßπ Appearance tab handler cleaned up")}catch(e){console.error("üö® Security: Error cleaning up Appearance tab:",e)}}onFormChange(e){try{const r=e.name||e.id;"color"===e.type?this.applyColorLivePreview(r,e.value):"range"===e.type?r.includes("borderRadius")||r.includes("BorderRadius")?this.applyBorderRadiusLivePreview(r,e.value):"highlightBackgroundOpacity"===r&&this.applyHighlightOpacityPreview(e.value):(r.includes("Font")||r.includes("typography")||r.includes("placeholder")||r.includes("focus"))&&this.applyTypographyPreview(r,e.value),this.core.onFormChange(e),console.log(`üé® Appearance form change: ${r} = ${e.value}`)}catch(e){console.error("üö® Security: Error handling Appearance tab form change:",e)}}updateConfigFromForm(e){try{e.querySelectorAll("[name]").forEach(e=>{const r=e.getAttribute("name");if(!r)return;let o;if("checkbox"===e.type)o=e.checked;else if("number"===e.type||"range"===e.type)o=""===e.value?null:parseFloat(e.value);else if("color"===e.type){o=e.value;const r=e.parentNode.querySelector(".color-hex-input");r&&(r.value=o.toUpperCase())}else o=e.value;this.core.safeSetNestedProperty(this.core.config,r,o)}),e.querySelectorAll(".color-hex-input").forEach(e=>{const r=e.parentNode.querySelector(".color-input");if(r&&r.name){const o=e.value;/^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/.test(o)&&(r.value=o,this.core.safeSetNestedProperty(this.core.config,r.name,o))}}),console.log("üé® Appearance tab config updated from form")}catch(e){console.error("üö® Security: Error updating config from Appearance tab form:",e)}}}"undefined"!=typeof module&&module.exports?module.exports=AppearanceTabHandler:window.AppearanceTabHandler=AppearanceTabHandler;