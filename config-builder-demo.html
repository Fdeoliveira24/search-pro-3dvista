<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Search Pro Config Builder - Demo</title>
    <style>
        body { 
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; 
            max-width: 1200px; 
            margin: 0 auto; 
            padding: 20px; 
            line-height: 1.6; 
        }
        .section { 
            margin-bottom: 30px; 
            padding: 20px; 
            border: 1px solid #e5e7eb; 
            border-radius: 8px; 
        }
        .section h2 { 
            margin-top: 0; 
            color: #374151; 
            border-bottom: 2px solid #3b82f6; 
            padding-bottom: 8px; 
        }
        .form-group { 
            margin-bottom: 15px; 
        }
        label { 
            display: block; 
            font-weight: 600; 
            margin-bottom: 5px; 
            color: #374151; 
        }
        input, select, textarea { 
            width: 100%; 
            max-width: 300px; 
            padding: 8px 12px; 
            border: 1px solid #d1d5db; 
            border-radius: 4px; 
            font-size: 14px; 
        }
        input[type="checkbox"] { 
            width: auto; 
            margin-right: 8px; 
        }
        .checkbox-group { 
            display: flex; 
            align-items: center; 
            flex-wrap: wrap; 
        }
        .button { 
            background: #3b82f6; 
            color: white; 
            border: none; 
            padding: 12px 24px; 
            border-radius: 6px; 
            font-weight: 600; 
            cursor: pointer; 
            margin-right: 10px; 
            margin-bottom: 10px; 
        }
        .button:hover { 
            background: #2563eb; 
        }
        .button.secondary { 
            background: #6b7280; 
        }
        .button.secondary:hover { 
            background: #4b5563; 
        }
        .output { 
            background: #f9fafb; 
            border: 1px solid #e5e7eb; 
            border-radius: 4px; 
            padding: 15px; 
            margin-top: 20px; 
            font-family: 'Monaco', 'Menlo', 'Consolas', monospace; 
            font-size: 13px; 
        }
        .grid { 
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); 
            gap: 20px; 
        }
        .help-text { 
            font-size: 12px; 
            color: #6b7280; 
            margin-top: 4px; 
        }
        .status { 
            padding: 10px 15px; 
            border-radius: 4px; 
            margin: 10px 0; 
            font-weight: 600; 
        }
        .status.success { 
            background: #ecfdf5; 
            color: #065f46; 
            border: 1px solid #a7f3d0; 
        }
        .status.error { 
            background: #fef2f2; 
            color: #991b1b; 
            border: 1px solid #fecaca; 
        }
    </style>
</head>
<body>
    <h1>ðŸ”§ Search Pro Config Builder - Demo</h1>
    <p>Configure the 3DVista Search Pro plugin settings and apply them to your tour.</p>

    <form id="searchProConfigForm">
        
        <!-- A) General Settings -->
        <div class="section">
            <h2>A) General â†’ Search Bar Behavior</h2>
            <div class="grid">
                <div class="form-group">
                    <label for="minSearchChars">Min Search Characters</label>
                    <input type="number" name="minSearchChars" id="minSearchChars" value="2" min="1" max="10">
                    <div class="help-text">Minimum characters before search triggers</div>
                </div>
                
                <div class="form-group">
                    <div class="checkbox-group">
                        <input type="checkbox" name="autoHideMobile" id="autoHideMobile" checked>
                        <label for="autoHideMobile">Auto Hide on Mobile</label>
                    </div>
                </div>
                
                <div class="form-group">
                    <div class="checkbox-group">
                        <input type="checkbox" name="autoHideDesktop" id="autoHideDesktop">
                        <label for="autoHideDesktop">Auto Hide on Desktop</label>
                    </div>
                </div>
                
                <div class="form-group">
                    <div class="checkbox-group">
                        <input type="checkbox" name="showTagsInResults" id="showTagsInResults" checked>
                        <label for="showTagsInResults">Show Tags in Results</label>
                    </div>
                </div>
            </div>
        </div>

        <!-- B) Appearance -->
        <div class="section">
            <h2>B) Appearance (Container + Field)</h2>
            <div class="grid">
                <div class="form-group">
                    <label for="searchBarPosition">Search Bar Position</label>
                    <select name="searchBarPosition" id="searchBarPosition">
                        <option value="top-right" selected>Top Right</option>
                        <option value="top-left">Top Left</option>
                        <option value="bottom-left">Bottom Left</option>
                        <option value="bottom-right">Bottom Right</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="searchBarZIndex">Z-Index</label>
                    <input type="number" name="searchBarZIndex" id="searchBarZIndex" value="9999" min="1">
                </div>
                
                <div class="form-group">
                    <label for="searchBarWidth">Width</label>
                    <input type="text" name="searchBarWidth" id="searchBarWidth" value="350px" placeholder="e.g., 320px, 100%">
                </div>
                
                <div class="form-group">
                    <label for="searchBarPlaceholder">Placeholder Text</label>
                    <input type="text" name="searchBarPlaceholder" id="searchBarPlaceholder" value="Search tour..." placeholder="Enter placeholder text">
                </div>
                
                <div class="form-group">
                    <label for="searchFieldFontFamily">Font Family</label>
                    <input type="text" name="searchFieldFontFamily" id="searchFieldFontFamily" placeholder="e.g., Arial, Roboto">
                </div>
                
                <div class="form-group">
                    <label for="searchFieldFontSize">Font Size</label>
                    <input type="text" name="searchFieldFontSize" id="searchFieldFontSize" placeholder="e.g., 16px, 1rem">
                </div>
                
                <div class="form-group">
                    <label for="searchFieldFontWeight">Font Weight</label>
                    <select name="searchFieldFontWeight" id="searchFieldFontWeight">
                        <option value="">Default</option>
                        <option value="300">Light (300)</option>
                        <option value="400" selected>Normal (400)</option>
                        <option value="500">Medium (500)</option>
                        <option value="600">Semi-bold (600)</option>
                        <option value="700">Bold (700)</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="searchFieldColor">Text Color</label>
                    <input type="color" name="searchFieldColor" id="searchFieldColor" value="#1a1a1a">
                </div>
            </div>
        </div>

        <!-- C) Thumbnails -->
        <div class="section">
            <h2>C) Thumbnails</h2>
            <div class="grid">
                <div class="form-group">
                    <div class="checkbox-group">
                        <input type="checkbox" name="enableThumbnails" id="enableThumbnails" checked>
                        <label for="enableThumbnails">Enable Thumbnails</label>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="thumbnailSize">Thumbnail Size</label>
                    <select name="thumbnailSize" id="thumbnailSize">
                        <option value="small">Small</option>
                        <option value="medium" selected>Medium</option>
                        <option value="large">Large</option>
                        <option value="custom">Custom (specify below)</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="thumbnailSizeCustom">Custom Size (if selected above)</label>
                    <input type="text" name="thumbnailSizeCustom" id="thumbnailSizeCustom" placeholder="e.g., 64px">
                </div>
            </div>
            
            <h3>Default Images by Element Type</h3>
            <div class="grid">
                <div class="form-group">
                    <label for="defaultImagePanorama">Panorama Default</label>
                    <input type="url" name="defaultImagePanorama" id="defaultImagePanorama" placeholder="https://example.com/panorama.jpg">
                </div>
                <div class="form-group">
                    <label for="defaultImageHotspot">Hotspot Default</label>
                    <input type="url" name="defaultImageHotspot" id="defaultImageHotspot" placeholder="https://example.com/hotspot.jpg">
                </div>
                <div class="form-group">
                    <label for="defaultImagePolygon">Polygon Default</label>
                    <input type="url" name="defaultImagePolygon" id="defaultImagePolygon" placeholder="https://example.com/polygon.jpg">
                </div>
                <div class="form-group">
                    <label for="defaultImageVideo">Video Default</label>
                    <input type="url" name="defaultImageVideo" id="defaultImageVideo" placeholder="https://example.com/video.jpg">
                </div>
                <div class="form-group">
                    <label for="defaultImageImage">Image Default</label>
                    <input type="url" name="defaultImageImage" id="defaultImageImage" placeholder="https://example.com/image.jpg">
                </div>
                <div class="form-group">
                    <label for="defaultImageText">Text Default</label>
                    <input type="url" name="defaultImageText" id="defaultImageText" placeholder="https://example.com/text.jpg">
                </div>
                <div class="form-group">
                    <label for="defaultImage3DModel">3D Model Default</label>
                    <input type="url" name="defaultImage3DModel" id="defaultImage3DModel" placeholder="https://example.com/3dmodel.jpg">
                </div>
                <div class="form-group">
                    <label for="defaultImageContainer">Container Default</label>
                    <input type="url" name="defaultImageContainer" id="defaultImageContainer" placeholder="https://example.com/container.jpg">
                </div>
            </div>
        </div>

        <!-- D) Filters -->
        <div class="section">
            <h2>D) Filters</h2>
            
            <h3>Top Label Filter</h3>
            <div class="grid">
                <div class="form-group">
                    <label for="filterMode">Filter Mode</label>
                    <select name="filterMode" id="filterMode">
                        <option value="none" selected>No Filter</option>
                        <option value="whitelist">Whitelist (allow only)</option>
                        <option value="blacklist">Blacklist (exclude)</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="filterValueMatchMode">Match Mode</label>
                    <select name="filterValueMatchMode" id="filterValueMatchMode">
                        <option value="exact" selected>Exact Match</option>
                        <option value="contains">Contains</option>
                        <option value="startsWith">Starts With</option>
                        <option value="regex">Regular Expression</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="filterAllowedValues">Allowed Values (comma-separated)</label>
                    <input type="text" name="filterAllowedValues" id="filterAllowedValues" placeholder="value1, value2, value3">
                </div>
                <div class="form-group">
                    <label for="filterBlacklistedValues">Blacklisted Values (comma-separated)</label>
                    <input type="text" name="filterBlacklistedValues" id="filterBlacklistedValues" placeholder="exclude1, exclude2">
                </div>
            </div>
            
            <h3>Element Labels Filter</h3>
            <div class="grid">
                <div class="form-group">
                    <label for="elementLabelsFilterMode">Filter Mode</label>
                    <select name="elementLabelsFilterMode" id="elementLabelsFilterMode">
                        <option value="none" selected>No Filter</option>
                        <option value="whitelist">Whitelist</option>
                        <option value="blacklist">Blacklist</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="elementLabelsAllowed">Allowed Labels</label>
                    <input type="text" name="elementLabelsAllowed" id="elementLabelsAllowed" placeholder="label1, label2">
                </div>
                <div class="form-group">
                    <label for="elementLabelsBlacklisted">Blacklisted Labels</label>
                    <input type="text" name="elementLabelsBlacklisted" id="elementLabelsBlacklisted" placeholder="bad1, bad2">
                </div>
            </div>

            <h3>Tags Filter</h3>
            <div class="grid">
                <div class="form-group">
                    <label for="tagFilteringMode">Filter Mode</label>
                    <select name="tagFilteringMode" id="tagFilteringMode">
                        <option value="none" selected>No Filter</option>
                        <option value="whitelist">Whitelist</option>
                        <option value="blacklist">Blacklist</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="tagFilteringAllowed">Allowed Tags</label>
                    <input type="text" name="tagFilteringAllowed" id="tagFilteringAllowed" placeholder="tag1, tag2">
                    <div class="help-text">Tags will be normalized to lowercase</div>
                </div>
                <div class="form-group">
                    <label for="tagFilteringBlacklisted">Blacklisted Tags</label>
                    <input type="text" name="tagFilteringBlacklisted" id="tagFilteringBlacklisted" placeholder="spam, unwanted">
                </div>
            </div>
        </div>

        <!-- E) Inclusion Rules -->
        <div class="section">
            <h2>E) Inclusion Rules</h2>
            <div class="grid">
                <div class="form-group">
                    <div class="checkbox-group">
                        <input type="checkbox" name="unlabeledWithSubtitles" id="unlabeledWithSubtitles" checked>
                        <label for="unlabeledWithSubtitles">Include Unlabeled with Subtitles</label>
                    </div>
                </div>
                <div class="form-group">
                    <div class="checkbox-group">
                        <input type="checkbox" name="unlabeledWithTags" id="unlabeledWithTags" checked>
                        <label for="unlabeledWithTags">Include Unlabeled with Tags</label>
                    </div>
                </div>
                <div class="form-group">
                    <div class="checkbox-group">
                        <input type="checkbox" name="completelyBlank" id="completelyBlank">
                        <label for="completelyBlank">Include Completely Blank</label>
                    </div>
                </div>
            </div>

            <h3>Element Types to Include</h3>
            <div class="grid">
                <div class="form-group">
                    <div class="checkbox-group">
                        <input type="checkbox" name="includePanoramas" id="includePanoramas" checked>
                        <label for="includePanoramas">Include Panoramas</label>
                    </div>
                </div>
                <div class="form-group">
                    <div class="checkbox-group">
                        <input type="checkbox" name="includeHotspots" id="includeHotspots" checked>
                        <label for="includeHotspots">Include Hotspots</label>
                    </div>
                </div>
                <div class="form-group">
                    <div class="checkbox-group">
                        <input type="checkbox" name="includePolygons" id="includePolygons" checked>
                        <label for="includePolygons">Include Polygons</label>
                    </div>
                </div>
                <div class="form-group">
                    <div class="checkbox-group">
                        <input type="checkbox" name="includeVideos" id="includeVideos" checked>
                        <label for="includeVideos">Include Videos</label>
                    </div>
                </div>
                <div class="form-group">
                    <div class="checkbox-group">
                        <input type="checkbox" name="includeImages" id="includeImages" checked>
                        <label for="includeImages">Include Images</label>
                    </div>
                </div>
                <div class="form-group">
                    <div class="checkbox-group">
                        <input type="checkbox" name="includeText" id="includeText" checked>
                        <label for="includeText">Include Text Elements</label>
                    </div>
                </div>
                <div class="form-group">
                    <div class="checkbox-group">
                        <input type="checkbox" name="include3DModels" id="include3DModels" checked>
                        <label for="include3DModels">Include 3D Models</label>
                    </div>
                </div>
                <div class="form-group">
                    <div class="checkbox-group">
                        <input type="checkbox" name="includeContainers" id="includeContainers" checked>
                        <label for="includeContainers">Include Containers</label>
                    </div>
                </div>
            </div>
        </div>

    </form>

    <!-- Action Buttons -->
    <div style="text-align: center; margin: 30px 0;">
        <button type="button" class="button" onclick="generateConfig()">ðŸ”§ Generate Config</button>
        <button type="button" class="button" onclick="applyConfig()">ðŸ’¾ Apply to Tour</button>
        <button type="button" class="button secondary" onclick="resetForm()">ðŸ”„ Reset Form</button>
        <button type="button" class="button secondary" onclick="loadFromLocalStorage()">ðŸ“¥ Load from LocalStorage</button>
    </div>

    <!-- Status Messages -->
    <div id="statusMessages"></div>

    <!-- Generated Configuration Output -->
    <div class="output">
        <h3>Generated Configuration:</h3>
        <pre id="configOutput">{}</pre>
    </div>

    <!-- Load the config builder -->
    <script src="search-pro-non-mod/js/buildSearchProConfig.js"></script>
    
    <script>
        // Demo page functionality
        function generateConfig() {
            const form = document.getElementById('searchProConfigForm');
            const config = buildSearchProConfig(form);
            document.getElementById('configOutput').textContent = JSON.stringify(config, null, 2);
            showStatus('Configuration generated successfully!', 'success');
        }

        function applyConfig() {
            const form = document.getElementById('searchProConfigForm');
            const success = persistSearchProConfig(form, { allowReload: false });
            
            if (success) {
                showStatus('Configuration applied and saved to localStorage! The tour will use these settings.', 'success');
                // Also update the display
                generateConfig();
            } else {
                showStatus('Failed to apply configuration. Please check the console for errors.', 'error');
            }
        }

        function resetForm() {
            document.getElementById('searchProConfigForm').reset();
            document.getElementById('configOutput').textContent = '{}';
            showStatus('Form reset to default values.', 'success');
        }

        function loadFromLocalStorage() {
            try {
                const saved = localStorage.getItem('searchProConfigUpdate');
                if (saved) {
                    const config = JSON.parse(saved);
                    populateFormFromConfig(config);
                    document.getElementById('configOutput').textContent = JSON.stringify(config, null, 2);
                    showStatus('Configuration loaded from localStorage.', 'success');
                } else {
                    showStatus('No saved configuration found in localStorage.', 'error');
                }
            } catch (error) {
                showStatus('Error loading configuration: ' + error.message, 'error');
            }
        }

        function populateFormFromConfig(config) {
            const form = document.getElementById('searchProConfigForm');
            
            // Helper to set form values
            function setValue(name, value) {
                const element = form.querySelector(`[name="${name}"]`);
                if (element) {
                    if (element.type === 'checkbox') {
                        element.checked = Boolean(value);
                    } else {
                        element.value = value || '';
                    }
                }
            }
            
            // Populate basic values
            if (config.minSearchChars) setValue('minSearchChars', config.minSearchChars);
            if (config.autoHide) {
                if (config.autoHide.mobile !== undefined) setValue('autoHideMobile', config.autoHide.mobile);
                if (config.autoHide.desktop !== undefined) setValue('autoHideDesktop', config.autoHide.desktop);
            }
            if (config.showTagsInResults !== undefined) setValue('showTagsInResults', config.showTagsInResults);
            
            // Appearance
            if (config.appearance?.searchBar) {
                const sb = config.appearance.searchBar;
                if (sb.position) setValue('searchBarPosition', sb.position);
                if (sb.zIndex) setValue('searchBarZIndex', sb.zIndex);
                if (sb.width) setValue('searchBarWidth', sb.width);
                if (sb.placeholder) setValue('searchBarPlaceholder', sb.placeholder);
            }
            
            // ... (continue for other sections as needed)
        }

        function showStatus(message, type) {
            const statusDiv = document.getElementById('statusMessages');
            statusDiv.innerHTML = `<div class="status ${type}">${message}</div>`;
            
            // Clear after 5 seconds
            setTimeout(() => {
                statusDiv.innerHTML = '';
            }, 5000);
        }

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Search Pro Config Builder Demo loaded');
            generateConfig(); // Show initial config
        });
    </script>

</body>
</html>
